<?xml version="1.0" standalone="no"?>

<kickstart>


	<description>
	Your gromacs roll description here
	</description>

	<copyright>
	Copyright (c) 2000 - 2011 The Regents of the University of California.
	All rights reserved. Rocks(r) v5.4.3 www.rocksclusters.org
	
	</copyright>

	<changelog>
	$Log: gromacs-server.xml,v $
	Revision 1.1  2012/01/25 02:35:58  clem
	- updated some path for the cadd pipeline script
	   /opt/opal/deployed for all the opal deployed scripts
	   /opt/cadd/bin for cadd related scripts
	- more gromacs scripts in place
	
	</changelog>


	<package>gromacs</package>
	<package>gromacs-opal</package>
	<package>gromacs-cadd</package>
	<package>rocks-gromacs</package>
	<package>roll-gromacs-usersguide</package>

<post os="linux" arch="x86_64">

if [ -d /opt/opal ]; then
    #ok we have opal installed
    #let's deploy the 

<file name="/opt/opal/deployed/deploy.sh" mode="append">
gromacs_script=/opt/cadd/bin/gromos_cluster_files.sh
if test -e $gromacs_script; then
    $ANT -f $OPALXML deploy -DserviceName=gromos_cluster_4.5.5 -DappConfig=$OPALCONFIG/gromos_cluster_4.5.5_config.xml
fi
</file>

    export JAVA_HOME=/usr/java/latest
    export PATH=$JAVA_HOME/bin:$PATH
    export CATALINA_HOME=/opt/tomcat
    #takes a little longer in this way but less code to write
    /bin/su tomcat -c "/opt/opal/deployed/deploy.sh"

fi
</post>

</kickstart>
